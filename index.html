<!DOCTYPE html>
<html>

	<head>
		<meta charset='utf-8'>
		<meta http-equiv="X-UA-Compatible" content="chrome=1">
		<meta name="description" content="Graph-x2 : Easy to use Graphics System built using Three.js">

		<link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

		<title>Graph-X2</title>
		
		<script src="GX2/three/Three59.js"></script>
		<script src="GX2/shaders/EffectComposer.js"></script>
		<script src="GX2/shaders/ShaderExtras.js"></script>
		<script src="GX2/shaders/ShaderPasses.js"></script>
		<script src="GX2/shaders/ShaderParticleEmitter.js"></script>
		<script src="GX2/shaders/ShaderParticleGroup.js"></script>
		<script src="GX2/utils/KeyboardState.js"></script>
		<script src="GX2/utils/FullScreen.js"></script>
		<script src="GX2/utils/FixedQueue.js"></script>
		<script src="GX2/utils/SimplexNoise.js"></script>
		<script src="GX2/utils/Detector.js"></script>
		<script src="GX2/utils/GamePad.js"></script>
		<script src="GX2/utils/Tween.js"></script>
		<script src="GX2/utils/AES.js"></script>
		<script src="GX2/physics/p2.js"></script>
		<script src="GX2/physics/p2.extras.js"></script>
		<script src="GX2/GX2Utilities.js"></script>
		<script src="GX2/GX2.js"></script>
		<script src="GX2/GX2Controls.js"></script>
		<script src="GX2/GX2System.js"></script>
		<script src="GX2/GX2Visualizers.js"></script>
		
	</head>

	<body style="background: black !important;">
	
		<script> 

		/* Simple GX2 Example Script   
		 * @author brokedRobot / http://www.prismshards.com/
		 */

			var gs;
			var windowready = false;

			var winW = 0; var conW = 0; var oldconW = 0;
			var winH = 0; var conH = 0; var oldconH = 0;

			window.onbeforeunload = function(e) {
				/*if (gs && gs.areasinmemory){
					setLocalDBObject('areasinmemory', gs.areasinmemory);
				}*/
			};
			 
			function beginGS(){

				windowready = true;
				
				gs = new GX2System({
					name: 'gs1',
					container: document.getElementById('gs_container_1'),
					createArea: createArea,
					firstarea: 'initial',
					autocenter: true,
					tweenupdating: true,
					sideborder: false,
					pauseonblur: true,
					attachpath: 'GX2'
				});

				window.onresize = function(){
				
					winW = window.innerWidth; conW = oldconW;
					winH = window.innerHeight; conH = oldconH; 
					
					var maxsize = winH*1.50; var leftoffset = 0;
					
					leftoffset = ((winW - conW*1.5) / 2);
					if (winW > maxsize) winW = maxsize;
					winW *= window.devicePixelRatio;
					
					oldconW = winW * 0.68; oldconH = oldconW * 0.60;
					if (leftoffset < 0) leftoffset = 0;
					
					var tr = document.querySelectorAll('.resize');
					if (tr) for (var i=0; i<tr.length; i++){
						tr[i].style.fontSize = 
							(winW * 0.025 * $(tr[i]).data('size')) + 'px';
						tr[i].style.lineHeight = 
							(winW * 0.025 * $(tr[i]).data('size')) + 'px';
					}
				
					for (var i=0; i<systems.length; i++) systems[i].resize();
					
				}
				
				window.onresize();
				
			}

			var thisGame = setInterval(function(){
				if ($('gs_container_1').length){
					clearInterval(thisGame);
					beginGS();
				}
			}, 600);

			document.addEventListener('DOMContentLoaded', function(){
				clearInterval(thisGame);
				beginGS();
			});

			//**************  GAME AREAS  *******************//

			function createArea(name, opts){

				var camera = gs.camera;
				var fx = gs.effects;
				
				var blackout = gs.blackout;
				var whiteout = gs.whiteout;
				var redout = gs.redout;
				var blueout = gs.blueout;
				var greenout = gs.greenout;
				var nopic = gs.nopic;

				for (var i = 0; i < gs.areasinmemory.length; i++) {
					if (gs.areasinmemory[i] !== null){
						if (gs.areasinmemory[i].name === name){
							console.log('found area to load from memory: ', gs.areasinmemory[i]);
							return gs.areasinmemory[i];
						}
					}
				}
				
				switch (name){ 
			//*******************************Initial Area***********************************// 
				case 'initial':
				
					var thisarea = new GX2Area({name: 'initial', graphscale: 1, system: gs});

					var gx2 = thisarea.addPicture({filename: 'images/graphx2.png',
						position: vec3( 0, 0, 50 ), opacity: 1, scale: 12, blending: 'normal',
						antialiased: false, name: 'gx2', centeroffset: vec3(0, 0, 0)});

					thisarea.setBegin(function (){
					
						blackout.fadeout();
						
						fx.staticPass.uniforms.size.value = 1;
			
						fx.resetComposer();
						
						fx.composer.addPass( fx.renderPass );
				
						fx.composer.addPass( fx.filmPass );
						fx.composer.addPass( fx.badtvPass );
						fx.composer.addPass( fx.rgbPass );
						fx.composer.addPass( fx.staticPass );
						fx.composer.addPass( fx.filmPass );		
						
						fx.composer.addPass( fx.copyPass );
						
						jiggle(fx, fx.badtvPass.uniforms.distortion, 4.5, 15, 15);
						jiggle(fx, fx.badtvPass.uniforms.distortion2, 4, 15, 15);
						//jiggle(fx, fx.badtvPass.uniforms.speed, 0.01, 15, 15);
						//jiggle(fx, fx.badtvPass.uniforms.rollSpeed, 0.01, 15, 15);
						jiggle(fx, fx.staticPass.uniforms.amount, 0.5, 18, 15);
						jiggle(fx, fx.rgbPass.uniforms.angle, 0.3, 18, 15);
						jiggle(fx, fx.rgbPass.uniforms.amount, 0.1, 18, 15);
						jiggle(fx, fx.filmPass.uniforms.nIntensity, 3, 18, 15);

					});
					
					return thisarea; 
					
				break; 
			//*******************************Default Case**********************************//
				default:
					console.log('Incorrect area name.');
					return false;
			  }
			}
			
			function jiggle(fx, obj, vi, vii, viii){
		
				var xi = Math.random()*vi;
				var xii = Math.random()*vii;
				if (viii) var xiii = Math.random()*viii;
				
				if (gs.framecounter % 5 == 0 || xi == 0){
					xi = 0.001;
				}
				
				if (viii)
					setTimeout(function(){
						tween({object: obj, 
							to: {value: xi}, time: xii, 
							onComplete: function(){
								jiggle(fx, obj, vi, vii, viii);
							}}).start();
					}, xiii);
				else
					tween({object: obj, 
						to: {value: xi}, time: xii, 
						onComplete: function(){
							jiggle(fx, obj, vi, vii);
						}}).start();
				
			}

		</script>

		<!-- HEADER -->
		<div id="header_wrap" class="outer" style="background: black !important;">
			<header class="inner">
				<a id="forkme_banner" href="https://github.com/brokedRobot/Graph-X2" style="background: url('images/blacktocat.png') orange no-repeat 95% 50% !important;">View on GitHub</a>

				<div class="noselect" id="gs_container_1" style="width: 400px;
					height: 140px; background: none; overflow: hidden; position: absolute;
					left: -50px; top: 0%; display: block; z-index: 1;"></div>
			  
				<h1 id="project_title" style="visibility: hidden; cursor: default;">Graph-X2</h1>
				<!--<br>-->
				<h2 id="project_tagline" style="position: relative; z-index: 50;">Easy to use Graphics System built using Three.js</h2>

				<section id="downloads">
				  <a class="zip_download_link" href="https://github.com/brokedRobot/Graph-X2/zipball/master">Download this project as a .zip file</a>
				  <a class="tar_download_link" href="https://github.com/brokedRobot/Graph-X2/tarball/master">Download this project as a tar.gz file</a>
				</section>
			</header>
		</div>

		<!-- MAIN CONTENT -->
		<div id="main_content_wrap" class="outer">
			<section id="main_content" class="inner">
		
				<h4>Graph-X2/GX2</h4>
		
				<p>GX2 is a simple to use, and (relatively) simple to install HTML graphics system.
				All of the code is client-side so no server-side code is necessary.</p>
			
				<p>GX2 is built on top of the Three.js library/renderer.</p>

				View the <a href="GX2/examples/index.html" target="_blank">examples page</a>.
				<br>&nbsp;

			</section>
		</div>

		<!-- FOOTER  -->
		<div id="footer_wrap" class="outer" style="background: black !important;">
			<footer class="inner">
				<p class="copyright" style="text-align: right;">Graph-X2 is maintained by <a href="https://github.com/brokedRobot" target="_blank">brokedRobot</a></p>
			</footer>
		</div>
		
	</body>
	
</html>
